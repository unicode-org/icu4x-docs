<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Normalizing text into Unicode Normalization Forms."><meta name="keywords" content="rust, rustlang, rust-lang, normalizer"><title>icu::normalizer - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../icu/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../icu/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate normalizer</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 1.0.0-beta1</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div></section><div id="sidebar-vars" data-name="normalizer" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../icu/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a href="../index.html">icu</a>::<wbr><a class="mod" href="#">normalizer</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/icu_normalizer/lib.rs.html#6-1964">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Normalizing text into Unicode Normalization Forms.</p>
<p>This module is published as its own crate (<a href="https://docs.rs/icu_normalizer/latest/icu_normalizer/"><code>icu_normalizer</code></a>)
and as part of the <a href="https://docs.rs/icu/latest/icu/"><code>icu</code></a> crate. See the latter for more details on the ICU4X project.</p>
<h2 id="implementation-notes"><a href="#implementation-notes">Implementation notes</a></h2>
<p>The normalizer operates on a lazy iterator over Unicode scalar values (Rust <code>char</code>) internally
and iterating over guaranteed-valid UTF-8, potentially-invalid UTF-8, and potentially-invalid
UTF-16 is a step that doesn’t leak into the normalizer internals. UTF errors are treated as
U+FFFD.</p>
<p>The normalizer data layout is not based on the ICU4C design at all. Instead, the normalization
data layout is a clean-slate design optimized for the concept of fusing the NFD decomposition
into the collator. That is, the decomposing normalizer is a by-product of the collator-motivated
data layout.</p>
<p>Notably, the decomposition data structure is optimized for a starter decomposing to itself,
which is the most common case, and for a starter decomposing to a starter and a non-starter
on the Basic Multilingual Plane. Notably, in this case, the collator makes use of the
knowledge that the second character of such a decomposition is a non-starter. Therefore,
decomposition into two starters is handled by generic fallback path that looks the
decomposion from an array by offset and length instead of baking a BMP starter pair directly
into a trie value.</p>
<p>The decompositions into non-starters are hard-coded. At present in Unicode, these appear
to be special cases falling into three categories:</p>
<ol>
<li>Deprecated combining marks.</li>
<li>Particular Tibetan vowel sings.</li>
<li>NFKD only: half-width kana voicing marks.</li>
</ol>
<p>Hopefully Unicode never adds more decompositions into non-starters (other than a character
decomposing to itself), but if it does, a code update is needed instead of a mere data update.</p>
<p>The composing normalizer builds on the decomposing normalizer by performing the canonical
composition post-processing per spec. As an optimization, though, the composing normalizer
attempts to pass through already-normalized text consisting of starters that never combine
backwards and that map to themselves if followed by a character whose decomposition starts
with a starter that never combines backwards.</p>
<p>As a difference with ICU4C, the composing normalizer has only the simplest possible
passthrough (only one inversion list lookup per character in the best case) and the full
decompose-then-canonically-compose behavior, whereas ICU4C has other paths between these
extremes. The ICU4X collator doesn’t make use of the FCD concept at all in order to avoid
doing the work of checking whether the FCD condition holds.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="error/index.html" title="icu::normalizer::error mod">error</a></div><div class="item-right docblock-short"><p>Normalizer-specific error</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="provider/index.html" title="icu::normalizer::provider mod">provider</a></div><div class="item-right docblock-short"><p>Data structs for the normalizer</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="u24/index.html" title="icu::normalizer::u24 mod">u24</a></div><div class="item-right docblock-short"><p>Little-endian unaligned 24-bit unsigned integer.</p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CanonicalComposition.html" title="icu::normalizer::CanonicalComposition struct">CanonicalComposition</a></div><div class="item-right docblock-short"><p>A struct for providing the raw canonical composition operation.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CanonicalDecomposition.html" title="icu::normalizer::CanonicalDecomposition struct">CanonicalDecomposition</a></div><div class="item-right docblock-short"><p>A struct for providing the raw (non-recursive) canonical decomposition operation.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ComposingNormalizer.html" title="icu::normalizer::ComposingNormalizer struct">ComposingNormalizer</a></div><div class="item-right docblock-short"><p>A normalizer for performing composing normalization.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Composition.html" title="icu::normalizer::Composition struct">Composition</a></div><div class="item-right docblock-short"><p>An iterator adaptor that turns an <code>Iterator</code> over <code>char</code> into
a lazily-decomposed and then canonically composed <code>char</code> sequence.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DecomposingNormalizer.html" title="icu::normalizer::DecomposingNormalizer struct">DecomposingNormalizer</a></div><div class="item-right docblock-short"><p>A normalizer for performing decomposing normalization.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Decomposition.html" title="icu::normalizer::Decomposition struct">Decomposition</a></div><div class="item-right docblock-short"><p>An iterator adaptor that turns an <code>Iterator</code> over <code>char</code> into
a lazily-decomposed <code>char</code> sequence.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Decomposed.html" title="icu::normalizer::Decomposed enum">Decomposed</a></div><div class="item-right docblock-short"><p>The outcome of non-recursive canonical decomposition of a character.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="icu" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0 (fe5b13d68 2022-05-18)" ></div>
</body></html>